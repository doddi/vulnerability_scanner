package org.sonatype.vul_highlighter.listener;

import java.util.Map;

import org.sonatype.vul_highlighter.listener.maven.MavenProjectTypeDetector;

import com.google.common.collect.ImmutableMap;
import com.intellij.openapi.project.Project;
import com.intellij.openapi.project.ProjectManagerListener;
import org.jetbrains.annotations.NotNull;

public class ProjectChangeListener implements ProjectManagerListener
{
  private Map<String, ProjectTypeDetector> detectors;

  public ProjectChangeListener() {
    this.detectors = ImmutableMap.of(MavenProjectTypeDetector.NAME, new MavenProjectTypeDetector());
  }

  @Override
  public void projectOpened(@NotNull final Project project) {
    detectors.forEach((name, detector) -> {
      if (detector.detect(project)) {
        detector.start(project);
      }
    });
  }
}
