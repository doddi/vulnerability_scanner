package org.sonatype.vul_highlighter.service;

import java.util.Map;
import java.util.Optional;
import java.util.Set;

import org.sonatype.vul_highlighter.module.LibraryToScan;
import org.sonatype.vul_highlighter.module.VulnerableComponent;

import com.intellij.openapi.components.ServiceManager;

public interface VulnerabilityService
{
  static VulnerabilityService getInstance() {
    return ServiceManager.getService(VulnerabilityService.class);
  }

  /**
   * Initiate a scan to determine if {@param libraries} are vulnerable
   */
  void checkLibraries(Set<LibraryToScan> libraries);

  /**
   * Check if any of the classes associated with a vulnerable component exists,
   * this indicates that the import is indeed vulnrable.
   */
  Optional<VulnerableComponent> isVulnerable(String name);

  /**
   * Retrieve a map of components deemed to be vulnerable
   */
  Map<String, VulnerableComponent> getVulnerableComponents();
}
