package org.sonatype.vul_highlighter.service;

import java.util.List;
import java.util.Map;
import java.util.Optional;

import org.sonatype.vul_highlighter.module.VulnerableComponent;

import com.intellij.openapi.components.ServiceManager;
import org.jetbrains.idea.maven.model.MavenArtifact;

public interface VulnerabilityService
{
  static VulnerabilityService getInstance() {
    return ServiceManager.getService(VulnerabilityService.class);
  }

  /**
   * Initiate a scan to determine if {@param artifacts} are vulnerable
   */
  void scan(List<MavenArtifact> artifacts);

  /**
   * Check if any of the classes associated with a vulnerable component exists,
   * this indicates that the import is indeed vulnrable.
   */
  Optional<VulnerableComponent> isVulnerable(String name);

  /**
   * Retrieve a map of components deemed to be vulnerable
   */
  Map<String, VulnerableComponent> getVulnerableComponents();
}
