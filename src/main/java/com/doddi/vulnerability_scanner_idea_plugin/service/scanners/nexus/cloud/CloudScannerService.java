package com.doddi.vulnerability_scanner_idea_plugin.service.scanners.nexus.cloud;

import java.util.List;

import javax.inject.Named;

import org.sonatype.goodies.packageurl.PackageUrl;

import com.doddi.vulnerability_scanner_idea_plugin.service.scanners.nexus.NexusScanner;
import com.doddi.vulnerability_scanner_idea_plugin.service.scanners.nexus.iq.IQVulnerableComponent;
import com.doddi.vulnerability_scanner_idea_plugin.util.nexusiqclient.NexusIQClient;
import com.intellij.openapi.project.Project;
import org.jetbrains.annotations.NotNull;

@Named(CloudScannerService.NAME)
public class CloudScannerService
    extends NexusScanner
{
  public static final String NAME = "Sonatype - Cloud";


  @NotNull
  public List<IQVulnerableComponent> evaluateByRepository(final List<PackageUrl> componentsToScan,
                                                          final NexusIQClient client,
                                                          final Project project)
  {
    List<IQVulnerableComponent> vulnerableComponents = doEvaluateByRepository(
        componentsToScan, client, project);
    remediate(project, "cloud", vulnerableComponents);
    return vulnerableComponents;
  }

  @Override
  public String getName() {
    return NAME;
  }

  @Override
  public String getUrl() {
    return "https://www.sonatype.com";
  }
}
