package com.doddi.vulnerability_scanner_idea_plugin.service.scanners.nexus.iq;

import java.util.List;

import javax.inject.Named;

import org.sonatype.goodies.packageurl.PackageUrl;

import com.doddi.vulnerability_scanner_idea_plugin.service.scanners.nexus.NexusScanner;
import com.doddi.vulnerability_scanner_idea_plugin.util.nexusiqclient.NexusIQClient;
import com.intellij.openapi.project.Project;
import org.jetbrains.annotations.NotNull;

@Named(IQScannerService.NAME)
public class IQScannerService
    extends NexusScanner
{
  protected static final String NAME = "Sonatype - Nexus IQ";

  @NotNull
  public List<IQVulnerableComponent> evaluateByRepository(final List<PackageUrl> componentsToScan,
                                                          final NexusIQClient client,
                                                          final Project project)
  {
    return doEvaluateByRepository(
        componentsToScan, client, project);
  }

  @Override
  public String getName() {
    return NAME;
  }

  @Override
  public String getUrl() {
    return "https://www.sonatype.com";
  }
}
