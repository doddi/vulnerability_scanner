package com.doddi.vulnerability_scanner_idea_plugin.service;

import java.util.Collection;

import org.sonatype.goodies.packageurl.PackageUrl;

import com.doddi.vulnerability_scanner_idea_plugin.entity.VulnerableComponent;
import com.doddi.vulnerability_scanner_idea_plugin.service.vulnerability.VulnerabilityCacheServiceImpl.CacheResult;
import com.doddi.vulnerability_scanner_idea_plugin.service.vulnerability.VulnerabilityCacheServiceImpl.CachedScanResult;
import com.intellij.openapi.components.ServiceManager;
import com.intellij.openapi.project.Project;

public interface VulnerabilityCacheService
{
  static VulnerabilityCacheService getInstance(final Project project) {
    return ServiceManager.getService(project, VulnerabilityCacheService.class);
  }

  void setCacheExpiration(int millis);

  void clear();

  void cache(VulnerableComponent component);

  void cache(Collection<VulnerableComponent> components);

  CachedScanResult get(PackageUrl parse);

  void setMaxCacheSize(int size);

  CacheResult get(Collection<PackageUrl> purls);

  void cacheNonVulnerableComponents(Collection<PackageUrl> purls);

  void cacheNonVulnerableComponent(PackageUrl purl);
}
