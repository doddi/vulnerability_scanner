package com.doddi.vulnerability_scanner_idea_plugin.service;

import java.util.Map;
import java.util.Optional;
import java.util.Set;

import com.doddi.vulnerability_scanner_idea_plugin.entity.LibraryToScan;
import com.doddi.vulnerability_scanner_idea_plugin.entity.VulnerableComponent;
import com.doddi.vulnerability_scanner_idea_plugin.system.Populator;
import com.intellij.openapi.components.ServiceManager;

public interface VulnerabilityService
{
  static VulnerabilityService getInstance() {
    return ServiceManager.getService(VulnerabilityService.class);
  }

  void setPopulator(final Populator populator);

  /**
   * Initiate a scan to determine if {@param libraries} are vulnerable
   */
  void checkLibraries(Set<LibraryToScan> libraries);

  /**
   * Check if any of the classes associated with a vulnerable component exists,
   * this indicates that the import is indeed vulnerable.
   */
  Optional<VulnerableComponent> isVulnerable(String name);

  /**
   * Retrieve a map of components deemed to be vulnerable
   */
  Map<String, VulnerableComponent> getVulnerableComponents();
}
