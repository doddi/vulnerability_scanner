package com.doddi.vulnerability_scanner_idea_plugin.system.rust;

import java.util.Set;

import com.doddi.vulnerability_scanner_idea_plugin.entity.LibraryToScan;
import com.doddi.vulnerability_scanner_idea_plugin.system.FileBasedDetector;
import com.intellij.openapi.project.Project;

public class RustTypeDetector extends FileBasedDetector
{
  private static final String RUST_TYPE = "Rust";

  final TomlReader tomlReader;

  public RustTypeDetector() {
    super("Cargo.lock", RustPopulator.class);
    tomlReader = new TomlReader();
  }

  @Override
  public String getLanguageType() {
    return RUST_TYPE;
  }

  @Override
  public Set<LibraryToScan> getLibraryToScans(final Project project) {
    return tomlReader.getDependencies(project.getPresentableUrl() + "/" + filename);
  }
}
