package com.doddi.vulnerability_scanner_idea_plugin.system;

import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import java.util.Set;

import org.sonatype.goodies.packageurl.PackageUrl;

import com.doddi.vulnerability_scanner_idea_plugin.entity.LibraryToScan;
import com.doddi.vulnerability_scanner_idea_plugin.entity.VulnerableComponent;

public abstract class Populator
{
  protected final Map<String, VulnerableComponent> components = new HashMap<>();

  public abstract void populate(final Set<LibraryToScan> libraries,
                                final List<VulnerableComponent> vulnerableComponents);

  public abstract Map<String, VulnerableComponent> getVulnerableComponents();

  public abstract Optional<VulnerableComponent> isVulnerable(String name);

  public Optional<VulnerableComponent> isPackageVulnerable(PackageUrl packageUrl) {
    return components.values().stream()
        .filter(pack -> pack.getPackageUrl().equals(packageUrl))
        .findFirst();
  }
}
