package com.doddi.vulnerability_scanner_idea_plugin.system.golang;

import java.util.Set;

import com.doddi.vulnerability_scanner_idea_plugin.entity.LibraryToScan;
import com.doddi.vulnerability_scanner_idea_plugin.system.FileBasedDetector;
import com.doddi.vulnerability_scanner_idea_plugin.system.golang.gomod.GolangGomodDependencyParser;
import com.intellij.openapi.diagnostic.Logger;
import com.intellij.openapi.project.Project;

public class GolangTypeDetector
    extends FileBasedDetector
{
    public static final Logger LOGGER = Logger.getInstance(GolangTypeDetector.class);

    public static final String GOLANG_TYPE = "Golang";

    private final GolangGomodDependencyParser dependencyInspector;

    public GolangTypeDetector() {
        super("go.mod", GolangPopulator.class);
        dependencyInspector = new GolangGomodDependencyParser();
    }

    @Override
    public Set<LibraryToScan> getLibraryToScans(final Project project) {
        return dependencyInspector.getDependencies(project.getPresentableUrl() + "/" + filename);
    }
}
