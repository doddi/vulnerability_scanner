package com.doddi.vulnerability_scanner_idea_plugin.system.npm.packagelock;

import java.io.FileReader;
import java.io.IOException;
import java.io.InputStreamReader;

import com.google.gson.Gson;
import com.intellij.openapi.diagnostic.Logger;

public class PackageLockReader
{
  private static final Logger LOGGER = Logger.getInstance(PackageLockReader.class);

  private final Gson gson = new Gson();

  public PackageLock read(final String file) {
    try (InputStreamReader reader = new FileReader(file)) {
      return gson.fromJson(reader, PackageLock.class);
    }
    catch (IOException e) {
      LOGGER.warn("Unable to parse json", e);
    }

    return null;
  }
}
