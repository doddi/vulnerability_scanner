package com.doddi.vulnerability_scanner_idea_plugin.system.npm;

import com.doddi.vulnerability_scanner_idea_plugin.system.ViolationAnnotator;
import com.intellij.lang.annotation.AnnotationHolder;
import com.intellij.lang.ecmascript6.psi.ES6FromClause;
import com.intellij.lang.ecmascript6.psi.ES6ImportDeclaration;
import com.intellij.psi.PsiElement;
import org.jetbrains.annotations.NotNull;

public class JavascriptViolationAnnotator
    extends ViolationAnnotator
{
  @Override
  public void annotate(@NotNull final PsiElement element, @NotNull final AnnotationHolder holder) {
    if (element instanceof ES6ImportDeclaration) {
      final ES6ImportDeclaration importDeclaration = (ES6ImportDeclaration) element;
      final ES6FromClause fromClause = importDeclaration.getFromClause();
      showIfVulnerable(element.getProject(), holder, element.getTextRange(),
          fromClause.getReference().getCanonicalText());
    }
  }
}
