<idea-plugin>
  <id>com.doddi.vulnerability_scanner_idea_plugin</id>
  <name>IDEA Vulnerability Scanner</name>
  <vendor email="mark.dodgson@googlemail.com"></vendor>

  <idea-version since-build="202.6397.94" until-build="202.9999.*"/>

  <description><![CDATA[
    A plugin that monitors your OSS components usage<br>
    <em>Any components that show vulnerabilities are indicated within the editor</em>
    ]]></description>

  <depends>com.intellij.modules.platform</depends>
  <depends>com.intellij.modules.lang</depends>
  <depends optional="true" config-file="rust.xml">org.rust.lang</depends>
  <depends optional="true" config-file="java.xml">org.jetbrains.idea.maven</depends>
  <depends optional="true" config-file="golang.xml">org.jetbrains.plugins.go</depends>
  <depends optional="true" config-file="pypi.xml">Pythonid</depends>
  <depends optional="true" config-file="npm.xml">JavaScript</depends>

  <applicationListeners>
    <listener class="com.doddi.vulnerability_scanner_idea_plugin.system.ProjectChangeListener"
              topic="com.intellij.openapi.project.ProjectManagerListener"/>
  </applicationListeners>

  <projectListeners>
    <listener class="com.doddi.vulnerability_scanner_idea_plugin.AnnotationPopulatorImpl"
              topic="com.doddi.vulnerability_scanner_idea_plugin.AnnotationPopulator"/>
  </projectListeners>

  <extensions defaultExtensionNs="com.intellij">
    <projectConfigurable instance="com.doddi.vulnerability_scanner_idea_plugin.config.ProjectConfigurable"
                         nonDefaultProject="true"/>

    <applicationService
        serviceImplementation="com.doddi.vulnerability_scanner_idea_plugin.service.ScannerManagerService"/>

    <projectService serviceImplementation="com.doddi.vulnerability_scanner_idea_plugin.system.maven.MavenPopulator"/>
    <projectService
        serviceImplementation="com.doddi.vulnerability_scanner_idea_plugin.system.golang.GolangPopulator"/>
      <projectService serviceImplementation="com.doddi.vulnerability_scanner_idea_plugin.system.python.PythonPopulator"/>
      <projectService serviceImplementation="com.doddi.vulnerability_scanner_idea_plugin.system.rust.RustPopulator"/>
      <projectService serviceImplementation="com.doddi.vulnerability_scanner_idea_plugin.system.npm.NpmPopulator"/>

      <projectService serviceInterface="com.doddi.vulnerability_scanner_idea_plugin.service.VulnerabilityService"
                      serviceImplementation="com.doddi.vulnerability_scanner_idea_plugin.service.vulnerability.VulnerabilityServiceImpl"/>
      <projectService serviceImplementation="com.doddi.vulnerability_scanner_idea_plugin.config.ProjectSettings"/>

      <projectService serviceInterface="com.doddi.vulnerability_scanner_idea_plugin.service.VulnerabilityCacheService"
                      serviceImplementation="com.doddi.vulnerability_scanner_idea_plugin.service.vulnerability.VulnerabilityCacheServiceImpl"/>

      <applicationService
          serviceImplementation="com.doddi.vulnerability_scanner_idea_plugin.config.ApplicationSettings"/>
    <applicationService
        serviceImplementation="com.doddi.vulnerability_scanner_idea_plugin.util.PluginInformationProvider"/>

    <applicationService
        serviceImplementation="com.doddi.vulnerability_scanner_idea_plugin.service.scanners.ossindex.OssIndexScannerService"/>
    <applicationService
        serviceImplementation="com.doddi.vulnerability_scanner_idea_plugin.service.scanners.nexus.iq.IQScannerService"/>
    <applicationService
        serviceImplementation="com.doddi.vulnerability_scanner_idea_plugin.service.scanners.dummy.DummyScannerService"/>
    <applicationService
        serviceImplementation="com.doddi.vulnerability_scanner_idea_plugin.service.scanners.nexus.cloud.CloudScannerService"/>
  </extensions>

    <actions>
        <group id="Vulnerability.Scanner" popup="true" text="Vulnerability Scanner">
            <action id="Vulnerability.Scanner.Results"
                    class="com.doddi.vulnerability_scanner_idea_plugin.action.PopupDialogueAction"
                    text="Vulnerability Highlighter"
                    description="Vulnerability Summary"
                    icon="AllIcons.Actions.Preview">
            </action>

            <action id="Vulnerability.Scanner.Configuration"
                    class="com.doddi.vulnerability_scanner_idea_plugin.config.ConfigureProjectAction"
                    text="Configure Scanner"
                    icon="AllIcons.General.Settings">
            </action>
          <add-to-group group-id="ToolsMenu" anchor="last"/>
        </group>

    </actions>
</idea-plugin>